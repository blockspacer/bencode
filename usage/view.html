

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>View interface &mdash; Bencode 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Bencode 0.1.0 documentation" href="../index.html"/>
        <link rel="next" title="Events system" href="events.html"/>
        <link rel="prev" title="Value interface" href="value.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Bencode
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/bencode_format.html">Bencode format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/integration.html">Integration</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="value.html">Value interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">View interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#construction">Construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#type-checking">Type checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#access">Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparison">Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conversion">Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#standard-library-types-support">Standard library types support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events system</a></li>
<li class="toctree-l1"><a class="reference internal" href="encoding_decoding.html">Encoding and decoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="customization_points.html">Customization points</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/bvalue.html">Value interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/bview.html">View interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/encoding_and_decoding.html">Encoding and decoding</a></li>
</ul>
<p class="caption"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../other/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other/references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bencode</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>View interface</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/usage/view.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="view-interface">
<h1>View interface<a class="headerlink" href="#view-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> is a sum type that provides access to the values stored in a bencoded buffer.
It holds two pointers, one to a <code class="xref cpp cpp-class docutils literal"><span class="pre">descriptor</span></code> and a pointer to the bencoded buffer.</p>
<p>The <code class="xref cpp cpp-class docutils literal"><span class="pre">descriptor</span></code> describes the type and content of the bencoded token the
<a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> points to and where the data can be found in the bencoded buffer.
This information allows <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> to navigate through the bencoded buffer and provide access
to the values.</p>
<p><a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> is used together with four subclasses:
<a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode13integer_bviewE" title="bencode::integer_bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">integer_bview</span></code></a>, <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode12string_bviewE" title="bencode::string_bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">string_bview</span></code></a>, <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode10list_bviewE" title="bencode::list_bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">list_bview</span></code></a> and
<a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode10dict_bviewE" title="bencode::dict_bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">dict_bview</span></code></a>.
These satisfy <code class="xref cpp cpp-concept docutils literal"><span class="pre">bview_alternative_type</span></code>.
Each subclass provides an extra interface over the generic <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a>
for the corresponding bencode data type.</p>
<p><a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode13integer_bviewE" title="bencode::integer_bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">integer_bview</span></code></a> is implicitly convertible to <code class="xref cpp cpp-class docutils literal"><span class="pre">std::uint64_t</span></code>.
<a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode12string_bviewE" title="bencode::string_bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">string_bview</span></code></a> provides an interface almost equal to that of <code class="xref cpp cpp-class docutils literal"><span class="pre">std::string_view</span></code>.
<a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode10list_bviewE" title="bencode::list_bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">list_bview</span></code></a> provides the interface similiar to a const <code class="xref cpp cpp-class docutils literal"><span class="pre">std::vector</span></code>
<a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode10dict_bviewE" title="bencode::dict_bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">dict_bview</span></code></a> provides the interface similar to a const <code class="xref cpp cpp-class docutils literal"><span class="pre">std::map</span></code> with
<code class="xref cpp cpp-class docutils literal"><span class="pre">bc::string_bview</span></code>
keys and <code class="xref cpp cpp-class docutils literal"><span class="pre">bc::bview</span></code> values.</p>
</div>
<div class="section" id="construction">
<h2>Construction<a class="headerlink" href="#construction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> should rarely be constructed directly. <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> is the result of calling
<code class="xref cpp cpp-func docutils literal"><span class="pre">get_root()</span></code> on a <code class="xref cpp cpp-class docutils literal"><span class="pre">descriptor_table</span></code> instance which is the result of parsing
a bencoded string with <a class="reference internal" href="../reference/encoding_and_decoding.html#_CPPv2N7bencode11decode_viewENSt11string_viewE" title="bencode::decode_view"><code class="xref cpp cpp-func docutils literal"><span class="pre">decode_view()</span></code></a>.</p>
</div>
<div class="section" id="type-checking">
<h2>Type checking<a class="headerlink" href="#type-checking" title="Permalink to this headline">¶</a></h2>
<p>Checking the bencode data type described in a <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a>
can be done using the following functions:</p>
<ul class="simple">
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">bool</span> <span class="pre">is_integer(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">bool</span> <span class="pre">is_string(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">bool</span> <span class="pre">is_list(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">bool</span> <span class="pre">is_dict(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">template</span> <span class="pre">&lt;enum</span> <span class="pre">bencode_type</span> <span class="pre">E&gt;</span> <span class="pre">bool</span> <span class="pre">holds_alternative(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><a href="#id1"><span class="problematic" id="id2">:cpp:expr:`template \&lt;bview_alternative_type T&gt; bool holds_alternative(const T&amp;)`</span></a></li>
</ul>
</div>
<div class="section" id="access">
<h2>Access<a class="headerlink" href="#access" title="Permalink to this headline">¶</a></h2>
<p>Converting the <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> instance to the interface specific
for the bencode datatype it points to is done using accessor functions.</p>
<p>Throwing accessor function will throw <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode16bad_bview_accessE" title="bencode::bad_bview_access"><code class="xref cpp cpp-class docutils literal"><span class="pre">bad_bview_access</span></code></a> when trying to
convert a bview to a bview subclass that does not match the bencode data type.</p>
<ul class="simple">
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">const</span> <span class="pre">integer_bview&amp;</span> <span class="pre">get_integer(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">const</span> <span class="pre">string_bview&amp;</span> <span class="pre">get_string(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">const</span> <span class="pre">list_bview&amp;</span> <span class="pre">get_list(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">const</span> <span class="pre">dict_bview&amp;</span> <span class="pre">get_dict(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">template</span> <span class="pre">&lt;enum</span> <span class="pre">bencode_type</span> <span class="pre">E&gt;</span> <span class="pre">const</span> <span class="pre">bview_alternative_t&lt;E&gt;&amp;</span> <span class="pre">get(const</span> <span class="pre">bview&amp;)()</span></code></li>
<li><a href="#id3"><span class="problematic" id="id4">:cpp:expr:`template \&lt;bview_alternative_type T&gt; const T&amp; get(const bview&amp;)`</span></a></li>
</ul>
<p>Non throwing accessor function will return a <code class="xref cpp cpp-class docutils literal"><span class="pre">nullptr</span></code> when trying to convert
a bview to a bview subclass that does not match the bencode data type.</p>
<ul class="simple">
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">bool</span> <span class="pre">get_if_integer(const</span> <span class="pre">bview*)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">bool</span> <span class="pre">get_if_string(const</span> <span class="pre">bview*)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">bool</span> <span class="pre">get_if_list(const</span> <span class="pre">bview*)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">bool</span> <span class="pre">get_if_dict(const</span> <span class="pre">bview*)()</span></code></li>
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">template</span> <span class="pre">&lt;enum</span> <span class="pre">bencode_type</span> <span class="pre">E&gt;</span> <span class="pre">const</span> <span class="pre">bview_alternative_t&lt;E&gt;*</span> <span class="pre">get_if(const</span> <span class="pre">bview*)()</span></code></li>
<li><a href="#id5"><span class="problematic" id="id6">:cpp:expr:`template \&lt;bview_alternative_type T&gt; const T* get_if(const bview&amp;)`</span></a></li>
</ul>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="k">auto</span> <span class="n">dict_view</span> <span class="o">=</span> <span class="n">get_dict</span><span class="p">(</span><span class="n">root_element</span><span class="p">);</span>    <span class="c1">// return dict_bview instance</span>
<span class="k">auto</span> <span class="n">list_view</span> <span class="o">=</span> <span class="n">get_list</span><span class="p">(</span><span class="n">root_element</span><span class="p">)</span>     <span class="c1">// throws bad_bview_access</span>

<span class="c1">// type tag based check</span>
<span class="k">auto</span> <span class="n">get</span><span class="o">&lt;</span><span class="n">bc</span><span class="o">::</span><span class="n">btype</span><span class="o">::</span><span class="n">dict</span><span class="o">&gt;</span><span class="p">(</span><span class="n">root_element</span><span class="p">);</span>    <span class="c1">// return dict_bview instance</span>

<span class="c1">// bview type based check</span>
<span class="k">auto</span> <span class="n">get</span><span class="o">&lt;</span><span class="n">bc</span><span class="o">::</span><span class="n">dict_bview</span><span class="o">&gt;</span><span class="p">(</span><span class="n">root_element</span><span class="p">);</span>     <span class="c1">// return dict_bview instance</span>
</pre></div>
</div>
</div>
<div class="section" id="comparison">
<h2>Comparison<a class="headerlink" href="#comparison" title="Permalink to this headline">¶</a></h2>
<p>Most types can be compared with <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> instances.
When the bencode data type of the <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> is not
the same as the bencode type of the the type you compare with when serialized,
the fallback order is <cite>integer &lt; string &lt; list &lt; dict</cite></p>
<p>Conversion to user-defined types can be enabled by implementing
the necessary <a class="reference internal" href="customization_points.html#customization-compare-to-bview"><span class="std std-ref">customization point</span></a>.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">bview</span> <span class="n">b</span><span class="p">;</span>    <span class="c1">// b is a string_bview with text &quot;foo&quot;;</span>
<span class="n">b</span> <span class="o">==</span> <span class="s">&quot;foo&quot;</span>  <span class="c1">// return true</span>
<span class="n">b</span> <span class="o">&gt;</span> <span class="s">&quot;aa&quot;</span>    <span class="c1">// returns true</span>
<span class="n">b</span> <span class="o">&gt;</span> <span class="mi">3</span>       <span class="c1">// return true</span>
<span class="n">b</span> <span class="o">&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="p">{{</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">}};</span> <span class="c1">// return false</span>
</pre></div>
</div>
</div>
<div class="section" id="conversion">
<h2>Conversion<a class="headerlink" href="#conversion" title="Permalink to this headline">¶</a></h2>
<p>To copy the content of a <a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> value to a specific type, generic converters are used.
The throwing converter will throw <code class="xref cpp cpp-class docutils literal"><span class="pre">conversion_error</span></code> when an error occures.</p>
<ul class="simple">
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">template</span> <span class="pre">&lt;typename</span> <span class="pre">T&gt;</span> <span class="pre">T</span> <span class="pre">get_as(const</span> <span class="pre">bview&amp;)()</span></code></li>
</ul>
<p>The non throwing converter will return an expected type with the converted value
or an as <code class="xref cpp cpp-enum docutils literal"><span class="pre">conversion_errc</span></code> value.</p>
<ul class="simple">
<li><code class="xref cpp cpp-func docutils literal"><span class="pre">template</span> <span class="pre">&lt;typename</span> <span class="pre">T&gt;</span> <span class="pre">nonstd::expected&lt;T,</span> <span class="pre">conversion_errc&gt;</span> <span class="pre">try_get_as(const</span> <span class="pre">bview&amp;)()</span></code></li>
</ul>
<p><a class="reference internal" href="../reference/bview.html#_CPPv2N7bencode5bviewE" title="bencode::bview"><code class="xref cpp cpp-class docutils literal"><span class="pre">bview</span></code></a> values can be converted to any type that satisfies <code class="xref cpp cpp-concept docutils literal"><span class="pre">retrievable_from_bview</span></code>.
Conversion to user-defined types can be enabled by implementing
the necessary <a class="reference internal" href="customization_points.html#customization-convert-from-bview"><span class="std std-ref">customization point</span></a>.</p>
</div>
<div class="section" id="standard-library-types-support">
<h2>Standard library types support<a class="headerlink" href="#standard-library-types-support" title="Permalink to this headline">¶</a></h2>
<p>Operations described above are defined for most standard library types.
They are not enabled by default however and the right trait header must be included.
The easiest way is to include all traits but this will have a heavy impact on compile times.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// enable interoperability with all supported types.</span>
<span class="cp">#include</span> <span class="cpf">&lt;bencode/traits/all.hpp&quot;</span><span class="cp"></span>

<span class="c1">// enable interoperability with std::set, std::unordered_set</span>
<span class="cp">#include</span> <span class="cpf">&lt;bencode/traits/set.hpp&gt;</span><span class="cp"></span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="events.html" class="btn btn-neutral float-right" title="Events system" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="value.html" class="btn btn-neutral" title="Value interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>